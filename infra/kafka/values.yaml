# infra/kafka/values.yaml
# Production-ready values for apache/kafka
# Note: This file is a reference for the manifests; we are not using a Helm chart directly here,
# strictly speaking, but keeping it aligned with the "no bitnami" rule.

image:
  registry: docker.io
  repository: apache/kafka
  tag: 3.7.0

controller:
  replicaCount: 3
  persistence:
    enabled: true
    size: 20Gi
    storageClass: "standard-rwo"
  resources:
    enabled: true
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: 1000m
      memory: 2Gi
  
  # Kraft mode (No Zookeeper)
  # Apache Kafka 3.7+ uses Kraft by default or can be configured for it.
  
listeners:
  client:
    protocol: PLAINTEXT
  interbroker:
    protocol: PLAINTEXT
  external:
    protocol: PLAINTEXT
    
serviceAccount:
  create: true

metrics:
  kafka:
    enabled: true
    image:
      registry: docker.io
      # Apache Kafka doesn't bundle an exporter like Bitnami does out of the box in the same image usually,
      # but for now keeping the exporter config placeholder or removing if not used.
      repository: unknown/kafka-exporter
      tag: latest
  jmx:
    enabled: true

provisioning:
  enabled: true
  numPartitions: 3
  replicationFactor: 2 # For 3 nodes
  topics:
    - name: page.viewed
    - name: cta.clicked
    - name: checkout.redirected
    - name: conversion.completed
    - name: campaign.attributed
    - name: user.signup
    - name: checkout.completed
